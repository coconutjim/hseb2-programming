#VRML V2.0 utf8 JavaScript.wrl

Shape
{
  appearance Appearance
  {
    material DEF mat Material
    {
      diffuseColor 1 0 0
    } # Material
  } # Appearance
  geometry Sphere
  {
  } # Sphere
} # Shape

DEF ts TouchSensor
{
} # TouchSensor

DEF script Script
{
  directOutput TRUE
  mustEvaluate TRUE

  eventIn SFBool isActive
  eventOut SFColor color_changed
  field SFBool flag FALSE

  url "javascript:

    function isActive(value)
    {
      //print('isActive(' + value + ')'); // Debug output
      if (value == true)
      {
        if (flag == false)
        {
          flag = true;
          //print('color is green'); // Debug output
          color_changed = new SFColor(0, 1, 0);
        }
        else
        {
          flag = false;
          //print('color is red'); // Debug output
          color_changed = new SFColor(1, 0, 0);
        }
      }
    }

  "
} # Script

ROUTE ts.isActive TO script.isActive
ROUTE script.color_changed TO mat.set_diffuseColor
